---
title: "fig1 - microbes"
author: "Caroline Wheeler"
date: "4/27/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
```

read in data
```{r}
or <- read.csv("../data/modelling_binom_Oropharynx.csv")
or$location <- "OR"
oc <- read.csv("../data/modelling_binom_OralCavity.csv")
oc$location <- "OC"
lh <- read.csv("../data/modelling_binom_LarynxHypopharinx.csv")
lh$location <- "LH"

combo <- rbind(or, oc, lh)
```

Top 10 lowest p.values
```{r}
combo.sig <- head(arrange(combo, (p.value)), n=10)
  
combo.sig %>%
  ggplot(aes(x=estimate,
             y=reorder(term,estimate),
             fill=location)) + 
  geom_bar(stat = "identity") + 
  theme_bw() + 
  #ggtitle("Effect Size BRB vs. NMBA - Significant Taxa") +
  ylab("Microbe Classification") +
  scale_fill_manual(values = c("slategray3")) 
 
ggsave("../figures/fig1_effectsize_top10.png", width = 6, height = 4)
```
top 3 lowest p.values from each site
```{r}
or.sig <- head(arrange(or, (p.value)), n=3)
oc.sig <- head(arrange(oc, (p.value)), n=3)
lh.sig <- head(arrange(lh, (p.value)), n=3)
combo.sig <- rbind(or.sig, oc.sig, lh.sig)
  
combo.sig %>%
  ggplot(aes(x=estimate,
             y=reorder(term,estimate),
             fill=location)) + 
  geom_bar(stat = "identity") + 
  theme_bw() + 
  #ggtitle("Effect Size BRB vs. NMBA - Significant Taxa") +
  ylab("Microbe Classification") +
  scale_fill_manual(values = c("rosybrown", "slategray3", "yellow3")) 
 
ggsave("../figures/fig1_effectsize_top3.png", width = 6, height = 4)
```

# check some relevant microbes

```{r}
mics <- c("`s__Staphylococcus aureus`", "f__Papillomaviridae", "`s__Human gammaherpesvirus 4`", "`s__Candida albicans`", "`s__Helicobacter pylori`", "`s__Porphyromonas gingivalis`", "`s__Streptomyces katrae`", "`s__Streptomyces albus`")

combo.sig <- combo %>%
  filter(term %in% mics)

combo.sig %>%
  ggplot(aes(x=estimate,
             y=reorder(term,estimate),
             fill=location)) + 
  geom_bar(stat = "identity") + 
  theme_bw() + 
  #ggtitle("Effect Size BRB vs. NMBA - Significant Taxa") +
  ylab("Microbe Classification") +
  scale_fill_manual(values = c("rosybrown", "slategray3", "yellow3")) 
 
```
```{r}
mics <- c("`s__Candidatus Thiodictyon syntrophicum`", "`s__Theileria orientalis`", "`s__Betaproteobacteria bacterium GR16-43`", "	
`s__Streptococcus pyogenes`", "`s__Streptomyces katrae`", "`s__Streptomyces albus`")

combo.sig <- combo %>%
  filter(term %in% mics)

combo.sig %>%
  ggplot(aes(x=estimate,
             y=reorder(term,estimate),
             fill=location)) + 
  geom_bar(stat = "identity") + 
  theme_bw() + 
  #ggtitle("Effect Size BRB vs. NMBA - Significant Taxa") +
  ylab("") +
  scale_fill_manual(values = c("rosybrown", "slategray3", "yellow3")) 

ggsave("../figures/fig1_effectsize_selectmics.png", width = 6, height = 4)
```

